define("utils",["jquery","jqueryui"],function(e,t){var n={stringRegex:/^([a-zA-Z0-9]){0,1}([a-zA-Z0-9])+$/,emailRegex:/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/,displayValidationErrors:function(e){for(var t in e)e.hasOwnProperty(t)&&this.addValidationError(t,e[t]);this.showAlert("Warning!","Validation errors please try again.","alert-warning")},addValidationError:function(t,n){var r=t=="identity"||t=="verified"?e("#"+t).parent().parent():e("#"+t).parent().parent().parent();r.addClass("error"),e(".help-block",r).html(n)},removeValidationError:function(t,n){var r=t=="identity"||t=="verified"?e("#"+t).parent().parent():e("#"+t).parent().parent().parent();r.removeClass("error"),e(".help-block",r).html(n?n:"Completed successfully.")},showAlert:function(t,n,r){e(".alert").removeClass("alert-error alert-warning alert-success alert-info"),e(".alert").addClass(r),e(".alert .message").html("<strong>"+t+"</strong> "+n),e(".alert").show();var i=setTimeout("$('.alert').fadeOut('slow');",3e3);e(".alert").click(function(){clearTimeout(i),e("#message-icon").toggleClass("icon-lock")})},hideAlert:function(){e(".alert").hide()},gridLoader:function(){e("#loader").css("display","inline-block");var t=50,n=100,r=Math.floor(Math.random()*(n-t+1))+t;e(".bar").css("width",r+"%"),setTimeout("$('#loader').css('display','none');",300)},formLoader:function(){setTimeout("$('#user-form-modal').modal('hide');",300),e("#loading").css("display","inline-block");var t=50,n=100,r=Math.floor(Math.random()*(n-t+1))+t;e(".bar").css("width",r+"%"),setTimeout("$('#loading').css('display','none');",300)}};return n}),define("Router",["jquery","underscore","bootstrap","utils","backbone","HeaderView","UserListCollection","UserListView","UserAddView","UserEditView","UserAdd","User","UserModalView","UserReviewView","ProfilerView"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){var v=i.Router.extend({page:1,routes:{"":"home","index/page/:page":"pages","index/letter/:letter":"letters","index/page/:page/order/:order/sort/:sort":"sorting","index/add":"addUser","index/edit/id/:id":"editUser","index/view/id/:id":"viewUser"},initialize:function(){this.headerView=new s,this.headerView.render()},home:function(){var t=new o;t.fetch({success:function(n){var i=n.pages.current;e("#content").html((new u({model:t,page:i})).render().el),r.gridLoader()}}),this.headerView.menuItem("home-menu")},pages:function(t){var t=t?parseInt(t,10):1,n=new o;n.fetch({data:{page:t},success:function(i){e("#content").html((new u({model:n,page:t})).render().el),r.gridLoader()}}),this.headerView.menuItem("home-menu"),this.page=t},letters:function(t){var t=t?t:"",n=new o;n.fetch({data:{letter:t},success:function(i){e("#content").html((new u({model:n,letter:t})).render().el),r.gridLoader()}}),this.headerView.menuItem("home-menu")},sorting:function(t,n,i){var t=t?parseInt(t,10):1,s=new o;s.fetch({data:{page:t,order:n,sort:i},success:function(o){e("#content").html((new u({model:s,page:t,order:n,sort:i})).render().el),r.gridLoader()}}),this.headerView.menuItem("home-menu"),this.page=t},addUser:function(){var t=new l;e("#content").append((new a({model:t})).render().el),e("#user-form-modal").modal({show:!0,backdrop:!0,keyboard:!0}),e("#user-form-modal").show(),e("#modal-header").html("Add New User"),r.hideAlert(),this.headerView.menuItem("add-menu")},editUser:function(t){var n=new c({id:t}),r=this.page;n.fetch({success:function(t){e(document.body).append((new h).el),e("#user-modal-body").html((new f({model:n,page:r})).render().el),e("#user-form-modal").modal({show:!0,backdrop:!0,keyboard:!0}),e("#user-form-modal").show(),e("#modal-header").html("Edit User");try{e("#created").datepicker({dateFormat:"yy-mm-dd"})}catch(i){console&&console.log("datepicker error: "+i.message)}}}),this.headerView.menuItem("home-menu")},viewUser:function(t){var n=new c({id:t});n.fetch({success:function(t){e("#content").html((new p({model:n})).el),e("#profiler").html((new d({profiler:t.attributes.profiler})).render().el)}}),this.headerView.menuItem("home-menu")}});return v}),define("EmailCheck",["jquery","underscore","backbone"],function(e,t,n){var r=n.Model.extend({urlRoot:"index/email/email",idAttribute:"email"});return r}),define("NameCheck",["jquery","underscore","backbone"],function(e,t,n){var r=n.Model.extend({urlRoot:"index/username/username",idAttribute:"username"});return r}),define("User",["jquery","underscore","utils","backbone"],function(e,t,n,r){var i=r.Model.extend({urlRoot:"index/edit/id",idAttribute:"id",initialize:function(){this.validators={},this.validators.username=function(e){return e.length===0?{isValid:!1,message:"You must choose a username."}:n.stringRegex.test(e)?{isValid:!0,message:"Everything looks good!"}:{isValid:!1,message:"You must enter a valid username!"}},this.validators.fullname=function(e){return e.length===0?{isValid:!1,message:"You must enter your full name."}:{isValid:!0,message:"Completed successfully!"}},this.validators.email=function(e){return e.length===0?{isValid:!1,message:"You must enter an email address!"}:n.emailRegex.test(e)?{isValid:!0,message:"Completed successfully!"}:{isValid:!1,message:"You must enter a valid email address!"}},this.validators.identity=function(e){return e==="-1"?{isValid:!1,message:"You must select a user identity level."}:{isValid:!0}},this.validators.validated=function(e){return e==="-1"?{isValid:!1,message:"You must select if user has been validated."}:{isValid:!0}}},validateItem:function(e){return this.validators[e]?this.validators[e](this.get(e)):{isValid:!0}},validateAll:function(){var e={};for(var n in this.validators)if(this.validators.hasOwnProperty(n)){var r=this.validators[n](this.get(n));r.isValid===!1&&(e[n]=r.message)}return t.size(e)>0?{isValid:!1,messages:e}:{isValid:!0}},defaults:{id:"",username:"",fullname:"",password:"",email:"",identity:"-1",verified:"-1",created:"",updated:""}});return i}),define("UserAdd",["jquery","underscore","backbone","User"],function(e,t,n,r){var i=r.extend({urlRoot:"index/add",defaults:{username:"",fullname:"",password:"",email:"",identity:"-1",verified:"-1",created:"",updated:""}});return i}),define("UserDelete",["jquery","underscore","backbone","User"],function(e,t,n,r){var i=r.extend({urlRoot:"index/delete/id"});return i}),define("UserList",["jquery","underscore","backbone"],function(e,t,n){var r=n.Model.extend({urlRoot:"index/list",idAttribute:"id",defaults:{items:{id:"",username:"",fullname:"",password:"",email:"",identity:0,verified:0,created:"",updated:""},pages:{current:"",currentItemCount:"",first:"",firstItemNumber:"",firstPageInRange:"",itemCountPerPage:"",last:"",lastItemNumber:"",lastPageInRange:"",next:"",pageCount:"",pagesInRange:{},totalItemCount:""}}});return r}),define("UserListCollection",["jquery","underscore","backbone","UserList"],function(e,t,n,r){var i=n.Collection.extend({model:r,url:"index/list",parse:function(e){return this.pages=e.pages,this.profiler=e.profiler,e.items},getPages:function(){return this.pages},getCurrentPage:function(){return this.pages.current}});return i}),define("HeaderView",["jquery","underscore","backbone"],function(e,t,n){var r=n.View.extend({el:".header",template:"#HeaderView",initialize:function(n){this.template=t.template(e(this.template).html()),this.render()},render:function(){return this.$el.html(this.template()),this},menuItem:function(t){e(".nav li").removeClass("active"),t&&e("."+t).addClass("active")}});return r}),define("PaginatorView",["jquery","underscore","backbone"],function(e,t,n){var r=n.View.extend({initialize:function(n){this.template=t.template(e("#PaginatorView").html())},render:function(t){return e(this.el).html(this.template({data:this.model.getPages()})),this}});return r}),define("ProfilerView",["jquery","underscore","backbone","handlebars"],function(e,t,n,r){var i=n.View.extend({initialize:function(t){this.profiler=this.options.profiler,this.template=r.compile(e("#ProfilerView").html())},render:function(t){return e(this.el).html(this.template({data:this.profiler})),this}});return i}),define("UserAddView",["jquery","underscore","utils","backbone","NameCheck","EmailCheck"],function(e,t,n,r,i,s){var o=r.View.extend({initialize:function(n){this.template=t.template(e("#UserAddView").html()),this.render()},events:{change:"change","blur input[id='username']":"checkUsername","blur input[id='email']":"checkEmail","click #submit":"beforeSave"},checkUsername:function(e){var t=e.target,r=new i;r.set({username:t.value}),r.fetch({success:function(e){var r=e.attributes;r.isValid===!1?n.addValidationError(t.id,r.message):n.stringRegex.test(t.value)?n.removeValidationError(t.id,r.message):n.addValidationError(t.id,"You must enter a valid username.")}})},checkEmail:function(e){var t=e.target,r=new s;r.set({email:t.value}),r.fetch({success:function(e){var r=e.attributes;r.isValid===!1?n.addValidationError(t.id,r.message):n.emailRegex.test(t.value)?n.removeValidationError(t.id,r.message):n.addValidationError(t.id,"You must enter a valid email address.")}})},change:function(e){var t=e.target,r={};r[t.name]=t.value,this.model.set(r);var i=this.model.validateItem(t.id);i.isValid===!1?n.addValidationError(t.id,i.message):n.removeValidationError(t.id)},render:function(n){return e(this.el).html(this.template(t.extend(this.model.toJSON()))),this},beforeSave:function(){var e=this.model.validateAll();return e.isValid===!1?(n.displayValidationErrors(e.messages),!1):(this.addUser(),!1)},addUser:function(){e("#user-form-modal").modal("hide");var t=1;this.model.save(null,{success:function(e){r.history.navigate("#index/page/"+t,!0),n.showAlert("Success!","Customer saved successfully!","alert-success")},error:function(){n.showAlert("Error","An error occurred saving this customer.","alert-error")}})}});return o}),define("UserEditView",["jquery","underscore","backbone","utils"],function(e,t,n,r){var i=n.View.extend({page:1,initialize:function(r){this.page=r.page,this.template=t.template(e("#UserEditView").html()),this.render(),n.View.prototype.eventAggregator=t.extend({},n.Events),this.eventAggregator.bind("beforeSave",this.beforeSave,this)},getPage:function(){return this.page},events:{change:"change"},change:function(e){r.hideAlert();var t=e.target,n={};n[t.name]=t.value,this.model.set(n);var i=this.model.validateItem(t.id);i.isValid===!1?r.addValidationError(t.id,i.message):r.removeValidationError(t.id)},render:function(n){return e(this.el).html(this.template(t.extend(this.model.toJSON()))),this},beforeSave:function(e){var t=this.model.validateAll();return t.isValid===!1?(r.displayValidationErrors(t.messages),!1):(r.formLoader(),this.updateUser(),!1)},updateUser:function(){var e=this.getPage();this.model.save(null,{success:function(t){n.history.navigate("#index/page/"+e,!0),r.showAlert("Success!","System user has been updated successfully!","alert-success")},error:function(){r.showAlert("Error","An error occurred while updating this user.","alert-error")}})}});return i}),define("UserListView",["jquery","jqueryui","utils","underscore","backbone","PaginatorView","ProfilerView","UserDelete"],function(e,t,n,r,i,s,o,u){var a=i.View.extend({template:r.template(e("#UserListView").html()),characters:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],letter:!1,page:1,sort:"asc",search:{username:"",fullname:"",email:"",identity:"-1",verified:"-1",created:""},initialize:function(e){this.page=this.options.page,this.sort=this.options.sort,this.letter=this.options.letter,this.model.bind("reset",this.render,this),this.model.bind("change",this.change,this)},events:{"mouseenter tr td button":"buttonOn","mouseleave tr td button":"buttonOff","click tr":"tableRowClick","click tr td button#delete":"tableRowDeleteButton","click tr td button#view":"tableRowViewButton","click #grid-submit":"gridsubmit","click #grid-reset":"gridreset"},render:function(t){e(this.el).html(this.template({users:this.model,page:this.page,sort:this.sort=="asc"?"desc":"asc",search:this.search,characters:this.characters,letter:this.letter})),e(this.el).prepend((new s({model:this.model})).render().el),e("#profiler").html((new o({profiler:this.model.profiler})).render().el);try{e("input[id='data[created]']",this.el).datepicker({dateFormat:"yy-mm-dd"})}catch(n){console&&console.log("datepicker error: "+n.message)}return this},buttonOn:function(t){e(this.el).undelegate("tr","click")},buttonOff:function(t){e(this.el).delegate("tr","click",this.tableRowClick)},tableRowClick:function(t){n.hideAlert();var r=e(t.target).closest("tr").attr("data-href");typeof r!="undefined"&&i.history.navigate(r,!0)},tableRowDeleteButton:function(t){n.hideAlert();var r=e(t.target).closest("tr").attr("id"),s=new u;return s.set({id:r}),s.destroy({success:function(e){i.history.navigate("#index/page/1",!0),n.showAlert("Success!","Customer deleted successfully!","alert-success")}}),!1},tableRowViewButton:function(t){var n=e(t.target).closest("tr").attr("id");i.history.navigate("#index/view/id/"+n,!0)},gridsubmit:function(t){this.search.username=this.$("input[id='data[username]']").val(),this.search.fullname=this.$("input[id='data[fullname]']").val(),this.search.email=this.$("input[id='data[email]']").val(),this.search.identity=this.$("select[id='data[identity]']").val(),this.search.verified=this.$("select[id='data[verified]']").val(),this.search.created=e("input[id='data[created]']",this.el).val(),this.model.fetch({data:this.search,type:"POST"}),n.gridLoader()},gridreset:function(e){i.history.navigate("/",!0)}});return a}),define("UserModalView",["jquery","underscore","backbone"],function(e,t,n){var r=n.View.extend({events:{"click #submit":"clickHandler"},clickHandler:function(e){this.eventAggregator.trigger("beforeSave")},initialize:function(n){this.template=t.template(e("#UserModalView").html()),this.render()},render:function(t){return e(this.el).html(this.template()),this}});return r}),define("UserReviewView",["jquery","underscore","backbone"],function(e,t,n){var r=n.View.extend({initialize:function(n){this.template=t.template(e("#UserReviewView").html()),this.render()},render:function(t){return e(this.el).html(this.template(this.model.toJSON())),this}});return r});